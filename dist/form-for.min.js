angular.module("formFor",[]),angular.module("formFor").directive("ariaManager",function(){return{restrict:"A",link:function(e,t,r){e.$watch("model.uid",function(e){r.$set("ariaDescribedby",e+"-error"),r.$set("ariaLabelledby",e+"-label")}),e.$watch("model.error",function(e){r.$set("ariaInvalid",!!e)})}}}),angular.module("formFor").directive("checkboxField",["$log","FieldHelper",function(e,t){return{require:"^formFor",restrict:"EA",templateUrl:"form-for/templates/checkbox-field.html",scope:{attribute:"@",disable:"=",help:"@?",changed:"@?"},link:function(r,i,a,o){if(!r.attribute)return void e.error('Missing required field "attribute"');r.tabIndex=a.tabIndex||0;i.find("input");r.toggle=function(){r.disable||r.model.disabled||(r.model.bindable=!r.model.bindable)},t.manageLabel(r,a),t.manageFieldRegistration(r,a,o)}}}]),angular.module("formFor").directive("collectionLabel",["$sce","FormForConfiguration",function(e){return{require:"^formFor",restrict:"EA",templateUrl:"form-for/templates/collection-label.html",scope:{attribute:"@",help:"@?",label:"@"},link:function(t,r,i,a){t.$watch("label",function(r){t.bindableLabel=e.trustAsHtml(r)}),t.model=a.registerCollectionLabel(t.attribute)}}}]),angular.module("formFor").directive("fieldError",["$sce","FormForConfiguration",function(){return{restrict:"EA",templateUrl:"form-for/templates/field-error.html",scope:{error:"=",leftAligned:"@?",uid:"@"}}}]),angular.module("formFor").directive("fieldLabel",["$sce","FormForConfiguration",function(e,t){return{restrict:"EA",replace:!0,templateUrl:"form-for/templates/field-label.html",scope:{inputUid:"@",help:"@?",label:"@",required:"@?",uid:"@"},controller:["$scope",function(r){r.$watch("label",function(t){r.bindableLabel=e.trustAsHtml(t)}),r.$watch("required",function(e){r.requiredLabel=r.$eval(e)?t.requiredLabel:null})}]}}]),angular.module("formFor").directive("formForDebounce",["$log","$sniffer","$timeout","FormForConfiguration",function(e,t,r,i){return{restrict:"A",require:"ngModel",priority:99,link:function(a,o,n,l){if("radio"===n.type||"checkbox"===n.type)return void e.warn("formForDebounce should only be used with <input type=text> and <textarea> elements");var s,u=n.formForDebounce,d=i.defaultDebounceDuration;if(void 0!==u&&("false"===u.toString()?d=!1:(u=parseInt(u),angular.isNumber(u)&&!isNaN(u)&&(d=u))),t.hasEvent("input")?o.off("input"):(o.off("keydown"),t.hasEvent("paste")&&o.off("paste")),d!==!1){var c=function(){r.cancel(s),s=r(function(){a.$apply(function(){l.$setViewValue(o.val())})},d)};t.hasEvent("input")?o.on("input",c):(o.on("keydown",c),t.hasEvent("paste")&&o.on("paste",c))}o.on("blur",function(){a.$apply(function(){l.$setViewValue(o.val())})}),a.$on("$destroy",function(){s&&r.cancel(s)})}}}]),angular.module("formFor").directive("formFor",["$injector","$log","$parse","$q","$sce","FormForConfiguration","$FormForStateHelper","$FormForGUID","NestedObjectHelper","ModelValidator",function(e,t,r,i,a,o,n,l,s,u){return{require:"form",restrict:"A",scope:{controller:"=?",disable:"=?",formFor:"=",service:"@",submitComplete:"&?",submitError:"&?",submitWith:"&?",valid:"=?",validateOn:"=?",validationFailed:"&?",validationRules:"=?"},controller:["$scope",function(o){o.formFor||t.error('The form data object specified by <form form-for=""> is null or undefined.'),o.fields={},o.collectionLabels={},o.buttons=[],o.service&&(o.$service=e.get(o.service)),o.$validationRules=o.$service?o.$service.validationRules:o.validationRules;var d=this;d.registerFormField=function(e){if(!e)throw Error('Invalid field name "'+e+'" provided.');var t=s.flattenAttribute(e);if(o.fields.hasOwnProperty(t))throw Error('Field "'+e+'" has already eben registered. Field names must be unique.');var i=(s.readAttribute(o.$validationRules,e),{bindableWrapper:{bindable:null,disabled:o.disable,error:null,pristine:!0,required:u.isFieldRequired(e,o.$validationRules),uid:l.create()},fieldName:e,unwatchers:[],validationAttribute:e.split("[")[0]});o.fields[t]=i;var a=r(e),n=a.assign;i.unwatchers.push(o.$watch("fields."+t+".bindableWrapper.bindable",function(e,t){e!==t&&n(o.formFor,e)}));var c;return i.unwatchers.push(o.$watch("formFor."+e,function(r,a){(r!==i.bindableWrapper.bindable||void 0===a&&""===r||void 0===r)&&(c=!1),i.bindableWrapper.bindable=r,o.validateOn&&"change"!==o.validateOn||d.validateField(e),c||(c=!0,o.formForStateHelper.setFieldHasBeenModified(t,!1)),i.bindableWrapper.pristine=!o.formForStateHelper.hasFieldBeenModified(t)})),i.bindableWrapper},this.unregisterFormField=function(e){var t=s.flattenAttribute(e);angular.forEach(o.fields[t].unwatchers,function(e){e()}),delete o.fields[t]},d.registerSubmitButton=function(){var e={disabled:!1};return o.buttons.push(e),e},d.registerCollectionLabel=function(e){var t=s.flattenAttribute(e),r={error:null,required:u.isCollectionRequired(e,o.$validationRules)};o.collectionLabels[t]=r;var i=!1;return o.$watch("formFor."+e+".length",function(){i?o.validateOn&&"change"!==o.validateOn||u.validateCollection(o.formFor,e,o.$validationRules).then(function(){o.formForStateHelper.setFieldError(t,null)},function(e){o.formForStateHelper.setFieldError(t,e)}):i=!0}),r},d.resetField=function(e){var t=s.flattenAttribute(e);o.formForStateHelper.getFieldError(t)&&(o.formForStateHelper.setFieldHasBeenModified(t,!1),o.fields[t].bindableWrapper.pristine=!0),o.formForStateHelper.setFieldError(t,null)},d.resetErrors=function(){for(var e in o.fields)o.formForStateHelper.getFieldError(e)&&(o.formForStateHelper.setFieldHasBeenModified(e,!1),o.fields[e].bindableWrapper.pristine=!0);o.formForStateHelper.setFormSubmitted(!1),o.formForStateHelper.resetFieldErrors()},d.resetFields=d.resetErrors,d.setFieldError=function(e,t){var r=s.flattenAttribute(e);o.formForStateHelper.setFieldHasBeenModified(r,!0),o.formForStateHelper.setFieldError(r,t)},d.validateField=function(e){{var t=s.flattenAttribute(e);o.fields[t],r(e)(o.formFor)}o.formForStateHelper.setFieldHasBeenModified(t,!0),o.$validationRules&&u.validateField(o.formFor,e,o.$validationRules).then(function(){o.formForStateHelper.setFieldError(t,null)},function(e){o.formForStateHelper.setFieldError(t,e)})},d.validateForm=function(e){o.updateCollectionErrors({}),o.updateFieldErrors({});var t,r;if(o.$validationRules){var a=[];angular.forEach(o.fields,function(e){a.push(e.fieldName)}),r=u.validateFields(o.formFor,a,o.$validationRules),r.then(angular.noop,o.updateFieldErrors),a=[],angular.forEach(o.collectionLabels,function(e,t){a.push(t)}),t=u.validateFields(o.formFor,a,o.$validationRules),t.then(angular.noop,o.updateCollectionErrors)}else t=i.resolve(),r=i.resolve();var n=i.defer();return i.waitForAll([t,r]).then(n.resolve,function(t){angular.isArray(t[0])&&0===t[0].length&&t.splice(0,1),e&&angular.forEach(t,function(e){var t=s.flattenObjectKeys(e);angular.forEach(t,function(t){var r=s.readAttribute(e,t);if(r){var i=s.flattenAttribute(t);o.formForStateHelper.setFieldHasBeenModified(i,!0)}})}),n.reject(t)}),n.promise},o.controller=o.controller||{},angular.copy(d,o.controller),o.$watch("disable",function(e){angular.forEach(o.fields,function(t){t.bindableWrapper.disabled=e}),angular.forEach(o.buttons,function(t){t.disabled=e})}),o.formForStateHelper=new n(o),o.$watch("formForStateHelper.watchable",function(){var e=o.formForStateHelper.hasFormBeenSubmitted();angular.forEach(o.fields,function(t,r){if(e||o.formForStateHelper.hasFieldBeenModified(r)){var i=o.formForStateHelper.getFieldError(r);t.bindableWrapper.error=i?a.trustAsHtml(i):null}else t.bindableWrapper.error=null}),angular.forEach(o.collectionLabels,function(e,t){var r=o.formForStateHelper.getFieldError(t);e.error=r?a.trustAsHtml(r):null})}),o.updateCollectionErrors=function(e){angular.forEach(o.collectionLabels,function(t,r){var i=s.readAttribute(e,r);o.formForStateHelper.setFieldError(r,i)})},o.updateFieldErrors=function(e){angular.forEach(o.fields,function(t,r){var i=s.readAttribute(e,t.fieldName);o.formForStateHelper.setFieldError(r,i)})}}],link:function(e,t,r){t.on("submit",function(){e.formForStateHelper.setFormSubmitted(!0),e.disable=!0;var t;return t="manual"===e.validateOn?i.resolve():e.controller.validateForm(),t.then(function(){var t;t=r.submitWith?e.submitWith({data:e.formFor}):e.$service&&e.$service.submit?e.$service.submit(e.formFor):i.reject("No submit function provided"),t||(t=i.reject("Submit function did not return a promise")),t.then(function(t){r.submitComplete?e.submitComplete({data:t}):o.defaultSubmitComplete(t)},function(t){angular.isObject(t)&&"manual"!==e.validateOn&&(e.updateCollectionErrors(t),e.updateFieldErrors(t)),r.submitError?e.submitError({error:t}):o.defaultSubmitError(t)}),t["finally"](function(){e.disable=!1})},function(){e.disable=!1,r.validationFailed?e.validationFailed():o.defaultValidationFailed()}),!1})}}}]),angular.module("formFor").directive("radioField",["$log","$FormForGUID","FieldHelper",function(e,t,r){var i={};return{require:"^formFor",restrict:"EA",templateUrl:"form-for/templates/radio-field.html",scope:{attribute:"@",disable:"=",help:"@?",value:"@"},link:function(a,o,n,l){if(!a.attribute)return void e.error('Missing required field "attribute"');if(i[a.attribute])a.hideErrorMessage=!0;else{var s={defaultScope:a,scopes:[]};r.manageFieldRegistration(a,n,l),i[a.attribute]=s}a.uid=n.uid||t.create();var u=i[a.attribute];u.scopes.push(a),r.manageLabel(a,n,!0),a.tabIndex=n.tabIndex||0;o.find("input");a.click=function(){a.disable||a.model.disabled||(a.model.bindable=a.value)},u.defaultScope.$watch("model",function(e){a.model=e}),u.defaultScope.$watch("disable",function(e){a.disable=e}),u.defaultScope.$watch("model.disabled",function(e){a.model&&(a.model.disabled=e)}),a.$watch("model.bindable",function(e){a.checked=void 0!==e&&null!==e&&void 0!==a.value&&null!==a.value&&e.toString()===a.value.toString()}),a.$on("$destroy",function(){u.scopes.splice(u.scopes.indexOf(a),1),0===u.scopes.length&&delete i[a.attribute]})}}}]),angular.module("formFor").directive("selectField",["$document","$log","$timeout","$window","FieldHelper",function(e,t,r,i,a){var o=10;return{require:"^formFor",restrict:"EA",templateUrl:"form-for/templates/select-field.html",scope:{attribute:"@",disable:"=",filter:"=?",filterDebounce:"@?",help:"@?",multiple:"=?",options:"="},link:function(n,l,s,u){if(i=angular.element(i),!n.attribute)return void t.error('Missing required field "attribute"');n.allowBlank=s.hasOwnProperty("allowBlank"),n.enableFiltering=s.hasOwnProperty("enableFiltering"),n.preventDefaultOption=s.hasOwnProperty("preventDefaultOption"),n.labelAttribute=s.labelAttribute||"label",n.valueAttribute=s.valueAttribute||"value",n.placeholder=s.placeholder||"Select",n.tabIndex=s.tabIndex||0,a.manageLabel(n,s),a.manageFieldRegistration(n,s,u);var d=function(e){var t=e[0];r(t.focus.bind(t))};n.close=function(){r(function(){n.isOpen=!1})},n.open=function(){n.disable||n.model.disabled||r(function(){n.isOpen=!0})},n.emptyOption={},n.emptyOption[n.labelAttribute]="",n.emptyOption[n.valueAttribute]=void 0,n.placeholderOption={},n.placeholderOption[n.labelAttribute]=n.placeholder,n.placeholderOption[n.valueAttribute]=void 0,n.filteredOptions=[];var c=function(e){return e&&e.toLowerCase()},f=function(){var e=n.options||[];if(n.filteredOptions.splice(0),n.enableFiltering&&n.filter){var t=c(n.filter);angular.forEach(e,function(e){var r=c(e[n.labelAttribute]).indexOf(t);r>=0&&n.filteredOptions.push(e)})}else angular.copy(e,n.filteredOptions);n.selectedOption||n.multiple?n.allowBlank&&n.filteredOptions.unshift(n.emptyOption):n.filteredOptions.unshift(n.placeholderOption)};n.$watch("filter",f),n.$watch("options.length",f);var m=function(){var e=n.selectedOption&&n.selectedOption[[n.valueAttribute]];return n.model.bindable===e?void(!n.allowBlank&&!n.preventDefaultOption&&n.options&&n.options.length&&(n.model.bindable=n.options[0][n.valueAttribute])):void 0};n.$watch("model.bindable",m),n.$watch("options.length",m),n.$watch("model.bindable",function(){var e;angular.forEach(n.options,function(t){t[n.valueAttribute]===n.model.bindable&&(e=t)}),n.selectedOption=e,n.selectedOptionLabel=e&&e[n.labelAttribute],n.filter=n.selectedOptionLabel});var p=function(e){e.ignoreFor!==n.model.uid&&n.close()};n.filterTextClick=function(){n.isOpen&&(event.ignoreFor=n.model.uid)};var b;n.$watch("isOpen",function(){b&&r.cancel(b),b=r(function(){b=null,n.isOpen?e.on("click",p):e.off("click",p)},o)}),n.$on("$destroy",function(){e.off("click",p)});var F=l.find("input");n.setFilterFocus=function(){d(F)},n.mouseOver=function(e){n.mouseOverIndex=e,n.mouseOverOption=e>=0?n.filteredOptions[e]:null},n.selectOption=function(e){n.model.bindable=e&&e[n.valueAttribute]},n.keyDown=function(e){switch(e.keyCode){case 27:n.close();break;case 13:n.isOpen?(n.selectOption(n.mouseOverOption),n.close()):n.open(),e.preventDefault();break;case 38:n.isOpen?n.mouseOver(n.mouseOverIndex>0?n.mouseOverIndex-1:n.filteredOptions.length-1):n.open();break;case 40:n.isOpen?n.mouseOver(n.mouseOverIndex<n.filteredOptions.length-1?n.mouseOverIndex+1:0):n.open();break;case 9:case 16:n.close();break;default:n.open()}},n.$watchCollection("[isOpen, filteredOptions.length]",function(){n.mouseOver(-1),n.isOpen&&n.enableFiltering&&d(F)})}}}]),angular.module("formFor").directive("submitButton",["$log","$sce",function(e,t){return{require:"^formFor",restrict:"EA",templateUrl:"form-for/templates/submit-button.html",scope:{disable:"=",icon:"@",label:"@"},link:function(e,r,i,a){e.buttonClass=i.buttonClass,e.tabIndex=i.tabIndex||0,e.$watch("label",function(r){e.bindableLabel=t.trustAsHtml(r)}),e.model=a.registerSubmitButton(e)}}}]),angular.module("formFor").directive("textField",["$log","$timeout","FieldHelper",function(e,t,r){return{require:"^formFor",restrict:"EA",templateUrl:"form-for/templates/text-field.html",scope:{attribute:"@",debounce:"@?",disable:"=",focused:"&?",blurred:"&?",help:"@?",iconAfterClicked:"&?",iconBeforeClicked:"&?",placeholder:"@?",rows:"=?"},link:function(i,a,o,n){if(!i.attribute)return void e.error('Missing required field "attribute"');if(i.attributes=o,i.rows=i.rows||3,i.type=o.type||"text",i.multiline=o.hasOwnProperty("multiline")&&"false"!==o.multiline,i.tabIndex=o.tabIndex||0,o.hasOwnProperty("autofocus")&&t(function(){a.find(i.multiline?"textarea":"input")[0].focus()}),r.manageLabel(i,o),r.manageFieldRegistration(i,o,n),o.iconAfter){var l=function(){if(i.model){var e="{"===o.iconAfter.charAt(0)?i.$eval(o.iconAfter):o.iconAfter;i.iconAfter=angular.isObject(e)?i.model.error?e.invalid:i.model.pristine?e.pristine:e.valid:e}};o.$observe("iconAfter",l),i.$watch("model.error",l),i.$watch("model.pristine",l)}if(o.iconBefore){var s=function(){if(i.model){var e="{"===o.iconBefore.charAt(0)?i.$eval(o.iconBefore):o.iconBefore;i.iconBefore=angular.isObject(e)?i.model.error?e.invalid:i.model.pristine?e.pristine:e.valid:e}};o.$observe("iconBefore",s),i.$watch("model.error",s),i.$watch("model.pristine",s)}i.onIconAfterClick=function(){o.hasOwnProperty("iconAfterClicked")&&i.iconAfterClicked()},i.onIconBeforeClick=function(){o.hasOwnProperty("iconBeforeClicked")&&i.iconBeforeClicked()},i.onFocus=function(){o.hasOwnProperty("focused")&&i.focused()},i.onBlur=function(){o.hasOwnProperty("blurred")&&i.blurred()}}}}]),angular.module("formFor").service("FieldHelper",["FormForConfiguration","StringUtil",function(e,t){this.manageLabel=function(r,i,a){i.hasOwnProperty("label")&&i.$observe("label",function(e){r.label=e}),e.autoGenerateLabels&&(r.label=t.humanize(a?r.value:r.attribute))},this.manageFieldRegistration=function(e,t,r){e.$watch("attribute",function(i,a){e.model&&r.unregisterFormField(a),e.model=r.registerFormField(e.attribute),t.uid&&(e.model.uid=t.uid)}),e.$on("$destroy",function(){r.unregisterFormField(e.attribute)})}}]),angular.module("formFor").service("FormForConfiguration",function(){return{autoGenerateLabels:!1,defaultDebounceDuration:500,defaultSubmitComplete:angular.noop,defaultSubmitError:angular.noop,defaultValidationFailed:angular.noop,requiredLabel:null,validationFailedForCustomMessage:"Failed custom validation",validationFailedForPatternMessage:"Invalid format",validationFailedForMaxCollectionSizeMessage:"Must be fewer than {{num}} items",validationFailedForMaxLengthMessage:"Must be fewer than {{num}} characters",validationFailedForMinCollectionSizeMessage:"Must at least {{num}} items",validationFailedForMinLengthMessage:"Must be at least {{num}} characters",validationFailedForRequiredMessage:"Required field",validationFailedForEmailTypeMessage:"Invalid email format",validationFailedForIntegerTypeMessage:"Must be an integer",validationFailedForNegativeTypeMessage:"Must be negative",validationFailedForNonNegativeTypeMessage:"Must be non-negative",validationFailedForNumericTypeMessage:"Must be numeric",validationFailedForPositiveTypeMessage:"Must be positive",disableAutoLabels:function(){this.autoGenerateLabels=!1},enableAutoLabels:function(){this.autoGenerateLabels=!0},setDefaultDebounceDuration:function(e){this.defaultDebounceDuration=e},setDefaultSubmitComplete:function(e){this.defaultSubmitComplete=e},setDefaultSubmitError:function(e){this.defaultSubmitError=e},setDefaultValidationFailed:function(e){this.defaultValidationFailed=e},setRequiredLabel:function(e){this.requiredLabel=e},setValidationFailedForCustomMessage:function(e){this.validationFailedForCustomMessage=e},setValidationFailedForMaxCollectionSizeMessage:function(e){this.validationFailedForMaxCollectionSizeMessage=e},setValidationFailedForMaxLengthMessage:function(e){this.validationFailedForMaxLengthMessage=e},setValidationFailedForMinCollectionSizeMessage:function(e){this.validationFailedForMaxCollectionSizeMessage=e},setValidationFailedForMinLengthMessage:function(e){this.validationFailedForMinLengthMessage=e},setValidationFailedForPatternMessage:function(e){this.validationFailedForPatternMessage=e},setValidationFailedForRequiredMessage:function(e){this.validationFailedForRequiredMessage=e},setValidationFailedForEmailTypeMessage:function(e){this.validationFailedForEmailTypeMessage=e},setValidationFailedForIntegerTypeMessage:function(e){this.validationFailedForIntegerTypeMessage=e},setValidationFailedForNegativeTypeMessage:function(e){this.validationFailedForNegativeTypeMessage=e},setValidationFailedForNonNegativeTypeMessage:function(e){this.validationFailedForNonNegativeTypeMessage=e},setValidationFailedForNumericTypeMessage:function(e){this.validationFailedForNumericTypeMessage=e},setValidationFailedForPositiveTypeMessage:function(e){this.validationFailedForPositiveTypeMessage=e}}}),angular.module("formFor").service("$FormForGUID",function(){return{create:function(){return("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)}}}),angular.module("formFor").factory("$FormForStateHelper",["NestedObjectHelper",function(e){var t=function(e){e.errorMap=e.errorMap||{},e.valid=!0,this.formScope=e,this.fieldNameToModificationMap={},this.formSubmitted=!1,this.shallowErrorMap={},this.watchable=0};return t.prototype.getFieldError=function(t){return e.readAttribute(this.formScope.errorMap,t)},t.prototype.hasFieldBeenModified=function(t){return e.readAttribute(this.fieldNameToModificationMap,t)},t.prototype.hasFormBeenSubmitted=function(){return this.formSubmitted},t.prototype.isFieldValid=function(e){return!getFieldError(e)},t.prototype.isFormInvalid=function(){return!this.isFormValid()},t.prototype.isFormValid=function(){for(var e in this.shallowErrorMap)return!1;return!0},t.prototype.resetFieldErrors=function(){this.formScope.errorMap={}},t.prototype.setFieldError=function(t,r){var i=e.flattenAttribute(t);e.writeAttribute(this.formScope.errorMap,t,r),r?this.shallowErrorMap[i]=r:delete this.shallowErrorMap[i],this.formScope.valid=this.isFormValid(),this.watchable++},t.prototype.setFieldHasBeenModified=function(t,r){e.writeAttribute(this.fieldNameToModificationMap,t,r),this.watchable++},t.prototype.setFormSubmitted=function(e){this.formSubmitted=e,this.watchable++},t}]),angular.module("formFor").service("ModelValidator",["$interpolate","$q","FormForConfiguration","NestedObjectHelper",function(e,t,r,i){return this.$getRulesForFieldName=function(e,t){return t=t.replace(/\[[^\]]+\]/g,".collection.fields"),i.readAttribute(e,t)},this.isCollectionRequired=function(e,t){var r=this.$getRulesForFieldName(t,e);return r&&r.collection&&r.collection.min&&(angular.isObject(r.collection.min)?r.collection.min.rule:r.collection.min)},this.isFieldRequired=function(e,t){var r=this.$getRulesForFieldName(t,e);return r&&r.required&&(angular.isObject(r.required)?r.required.rule:r.required)},this.validateAll=function(e,t){var r=i.flattenObjectKeys(t);return this.validateFields(e,r,t)},this.validateFields=function(e,r,a){var o=t.defer(),n=[],l={};return angular.forEach(r,function(t){var r=this.$getRulesForFieldName(a,t);if(r){var o;o=r.collection?this.validateCollection(e,t,a):this.validateField(e,t,a),o.then(angular.noop,function(e){i.writeAttribute(l,t,e)}),n.push(o)}},this),t.waitForAll(n).then(o.resolve,function(){o.reject(l)}),o.promise},this.validateCollection=function(a,o,n){var l=this.$getRulesForFieldName(n,o),s=i.readAttribute(a,o);if(l&&l.collection){s=s||[];var u=l.collection;if(u.min){var d=angular.isObject(u.min)?u.min.rule:u.min;if(s.length<d)return t.reject(angular.isObject(u.min)?u.min.message:e(r.validationFailedForMinCollectionSizeMessage)({num:d}))}if(u.max){var c=angular.isObject(u.max)?u.max.rule:u.max;if(s.length>c)return t.reject(angular.isObject(u.max)?u.max.message:e(r.validationFailedForMaxCollectionSizeMessage)({num:c}))}}return t.resolve()},this.validateField=function(a,o,n){var l=this.$getRulesForFieldName(n,o),s=i.readAttribute(a,o);if(l){if(s=s||"",l.required){var u=angular.isObject(l.required)?l.required.rule:l.required;if(angular.isString(s)&&(s=s.replace(/\s+$/,"")),!!s!==u)return t.reject(angular.isObject(l.required)?l.required.message:r.validationFailedForRequiredMessage)}if(l.minlength){var d=angular.isObject(l.minlength)?l.minlength.rule:l.minlength;if(s&&s.length<d)return t.reject(angular.isObject(l.minlength)?l.minlength.message:e(r.validationFailedForMinLengthMessage)({num:d}))}if(l.maxlength){var c=angular.isObject(l.maxlength)?l.maxlength.rule:l.maxlength;if(s.length>c)return t.reject(angular.isObject(l.maxlength)?l.maxlength.message:e(r.validationFailedForMaxLengthMessage)({num:c}))}if(l.type){var f=angular.isObject(l.type)?l.type.rule:l.type,m=s.toString(),p=Number(s);if(f){var b=f.split(" ");for(f in b)switch(f){case"integer":if(isNaN(p)||p%1!==0)return t.reject(angular.isObject(l.type)?l.type.message:r.validationFailedForIntegerTypeMessage);break;case"number":if(isNaN(p))return t.reject(angular.isObject(l.type)?l.type.message:r.validationFailedForNumericTypeMessage);break;case"negative":if(isNaN(p)||p>=0)return t.reject(angular.isObject(l.type)?l.type.message:r.validationFailedNegativeTypeMessage);break;case"nonNegative":if(isNaN(p)||0>p)return t.reject(angular.isObject(l.type)?l.type.message:r.validationFailedForNonNegativeTypeMessage);break;case"positive":if(isNaN(p)||0>=p)return t.reject(angular.isObject(l.type)?l.type.message:r.validationFailedForPositiveTypeMessage);break;case"email":if(m&&!m.match(/^.+@.+$/))return t.reject(angular.isObject(l.type)?l.type.message:r.validationFailedForEmailTypeMessage)}}}if(l.pattern){var F=l.pattern instanceof RegExp,v=F?l.pattern:l.pattern.rule;if(!v.exec(s))return t.reject(F?r.validationFailedForPatternMessage:l.pattern.message)}if(l.custom){var g=angular.isFunction(l.custom)?r.validationFailedForCustomMessage:l.custom.message,h=angular.isFunction(l.custom)?l.custom:l.custom.rule;try{var M=h(s,a)}catch($){return t.reject($.message||g)}return angular.isObject(M)&&angular.isFunction(M.then)?M.then(function(e){return t.resolve(e)},function(e){return t.reject(e||g)}):M?t.resolve(M):t.reject(g)}}return t.resolve()},this}]),angular.module("formFor").service("NestedObjectHelper",["$parse",function(e){return{$createEmptyArrays:function(e,t){for(var r=0;;){if(r=t.indexOf("[",r),0>r)break;var i=t.substr(0,r),a=this.readAttribute(e,i);a||(a=[],this.writeAttribute(e,i,a));var o=t.substr(r).match(/([0-9]+)\]\./);if(o){var n=parseInt(o[1]);a[n]||(a[n]={})}r++}},flattenAttribute:function(e){return e=e.replace(/\[([^\]]+)\]\.{0,1}/g,"___$1___"),e=e.replace(/\./g,"___")},flattenObjectKeys:function(e){for(var t=[],r=[{object:e,prefix:null}];;){if(0===r.length)break;var i=r.pop(),a=i.prefix?i.prefix+".":"";if("object"==typeof i.object)for(var o in i.object){var n=a+o;t.push(n),r.push({object:i.object[o],prefix:n})}}return t},readAttribute:function(t,r){return e(r)(t)},writeAttribute:function(t,r,i){this.$createEmptyArrays(t,r),e(r).assign(t,i)}}}]);var qDecorator=["$delegate",function(e){return e.resolve=function(e){var t=this.defer();return t.resolve(e),t.promise},e.waitForAll=function(e){var t=this.defer(),r=[],i=0,a=!1,o=function(e,t){r.hasOwnProperty(e)||(r[e]=t,i--),n()},n=function(){0===i&&(a?t.reject(r):t.resolve(r))};return angular.forEach(e,function(e,t){i++,e.then(function(e){o(t,e)},function(e){a=!0,o(t,e)})}),n(),t.promise},e}];angular.module("formFor").config(["$provide",function(e){e.decorator("$q",qDecorator)}]),angular.module("formFor").service("StringUtil",function(){this.humanize=function(e){return e?(e=e.replace(/[A-Z]/g,function(e){return" "+e}),e=e.replace(/_([a-z])/g,function(e,t){return" "+t.toUpperCase()}),e=e.replace(/\s+/g," "),e=e.trim(),e=e.charAt(0).toUpperCase()+e.slice(1)):""}});